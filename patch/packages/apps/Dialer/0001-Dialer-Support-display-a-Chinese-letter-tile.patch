From 7e4331aeebaeb48e928868a8b8e9cc42f3fc189b Mon Sep 17 00:00:00 2001
From: Martincz Gao <martincz@mokeedev.com>
Date: Wed, 2 Jan 2019 04:23:31 +0800
Subject: [PATCH 1/3] Dialer: Support display a Chinese letter tile

Change-Id: I0b8a844d97d29798b7f646482af5926e4dc235ee
---
 java/com/android/dialer/lettertile/LetterTileDrawable.java | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/java/com/android/dialer/lettertile/LetterTileDrawable.java b/java/com/android/dialer/lettertile/LetterTileDrawable.java
index b747c4f4..33329af2 100644
--- a/java/com/android/dialer/lettertile/LetterTileDrawable.java
+++ b/java/com/android/dialer/lettertile/LetterTileDrawable.java
@@ -1,5 +1,6 @@
 /*
  * Copyright (C) 2013 The Android Open Source Project
+ * Copyright (C) 2015-2019 The MoKee Open Source Project
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -113,6 +114,7 @@ public class LetterTileDrawable extends Drawable {
 
   private int color;
   private Character letter = null;
+  private boolean isChineseLetter = false;
 
   private String displayName;
 
@@ -214,7 +216,7 @@ public class LetterTileDrawable extends Drawable {
       firstChar[0] = letter;
 
       // Scale text by canvas bounds and user selected scaling factor
-      paint.setTextSize(scale * letterToTileRatio * minDimension);
+      paint.setTextSize(scale * letterToTileRatio * minDimension * (isChineseLetter ? 0.75f : 1f));
       paint.getTextBounds(firstChar, 0, 1, rect);
       paint.setTypeface(Typeface.create("sans-serif", Typeface.NORMAL));
       paint.setColor(tileFontColor);
@@ -337,6 +339,9 @@ public class LetterTileDrawable extends Drawable {
       final String displayName, final String identifier) {
     if (!TextUtils.isEmpty(displayName) && isEnglishLetter(displayName.charAt(0))) {
       letter = Character.toUpperCase(displayName.charAt(0));
+    } else if (!TextUtils.isEmpty(displayName) && com.mokee.utils.TextUtils.isChineseLetter(displayName.charAt(0))) {
+      letter = Character.toUpperCase(displayName.charAt(0));
+      isChineseLetter = true;
     } else {
       letter = null;
     }
-- 
2.20.1

